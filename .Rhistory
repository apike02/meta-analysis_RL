geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(medication_general)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of any psychiatric medication use') +
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
scale_x_discrete(breaks=c(1,2,3),labels=c('No','Yes, formerly','Yes, currently'))+
theme_classic()+
theme(legend.position='none')
d<-ggplot(data=data3_scores,aes(x=medication_anxdep,y=Cat,fill=medication_anxdep)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(medication_anxdep)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of medication use for anxiety or depression') +
scale_x_discrete(breaks=c(1,2,3),labels=c('No','Yes, formerly','Yes, currently'))+
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
theme_classic()+
theme(legend.position='none')
plot_grid(a,b,c,d,labels='AUTO')
if (save_images==1){
ggsave(file=paste0(workingdir,'/raincloud_plots.png'),height=9,width=12)
}
data3_scores$medication_general<-recode(data3_scores$medication_general,"'No'= 1;'Yes I took medication in the past'=2;'Yes I currently take medication'= 3")
data3_scores$medication_anxdep<-recode(data3_scores$medication_anxdep,"'No'= 1;'Yes I took medication in the past'=2;'Yes I currently take medication'= 3")
data3_scores$diagnosis_general<-ifelse(data3_scores$diagnosis_general=='yes',2,1)
data3_scores$diagnosis_anxdep<-ifelse(data3_scores$diagnosis_anxdep=='yes',2,1)
data3_scores$diagnosis_general<-factor(data3_scores$diagnosis_general)
data3_scores$diagnosis_anxdep<-factor(data3_scores$diagnosis_anxdep)
data3_scores$medication_general<-factor(data3_scores$medication_general)
data3_scores$medication_anxdep<-factor(data3_scores$medication_anxdep)
a<-ggplot(data=data3_scores,aes(x=diagnosis_general,y=Cat,fill=diagnosis_general)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(diagnosis_general)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of any mental illness') +
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
scale_x_discrete(breaks=c(1,2),labels=c('No','Yes'))+
theme_classic()+
theme(legend.position='none')
b<-ggplot(data=data3_scores,aes(x=diagnosis_anxdep,y=Cat,fill=diagnosis_anxdep)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(diagnosis_anxdep)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of anxiety or depression') +
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
scale_x_discrete(breaks=c(1,2),labels=c('No','Yes'))+
theme_classic()+
theme(legend.position='none')
c<-ggplot(data=data3_scores,aes(x=medication_general,y=Cat,fill=medication_general)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(medication_general)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of any psychiatric medication use') +
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
scale_x_discrete(breaks=c(1,2,3),labels=c('No','Yes, formerly','Yes, currently'))+
theme_classic()+
theme(legend.position='none')
d<-ggplot(data=data3_scores,aes(x=medication_anxdep,y=Cat,fill=medication_anxdep)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(medication_anxdep)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of medication use for anxiety or depression') +
scale_x_discrete(breaks=c(1,2,3),labels=c('No','Yes, formerly','Yes, currently'))+
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
theme_classic()+
theme(legend.position='none')
plot_grid(a,b,c,d,labels='AUTO')
if (save_images==1){
ggsave(file=paste0(workingdir,'/raincloud_plots.pdf'),height=9,width=12)
}
Cat<-rowSums(select(data3,contains('cata')))
scores<-data.frame(Cat)
scores$STAI<-rowSums(select(data3,contains('STAI')))
scores$PHQ<-rowSums(select(data3,contains('PHQ')))
scores$GAD<-rowSums(select(data3,contains('GAD')))
scores$RRS<-rowSums(select(data3,contains('RRS')))
scores$PSWQ<-rowSums(select(data3,contains('PSWQ')))
scores$TEPS_ANT<-rowSums(select(data3,contains('teps_ant')))
scores$TEPS_CON<-rowSums(select(data3,contains('teps_con')))
scores$CDS<-rowSums(select(data3,contains('cds')))
scores$short_cat<-rowSums(select(data3,c(contains('short_X')))) #the extra bit is needed so don't get the time
cormat <- round(cor(scores),2)
melted_cormat <- melt(cormat)
melted_cormat$Var1<-factor(melted_cormat$Var1,ordered=TRUE,levels=c('Cat','short_cat','CDS','GAD','PHQ','PSWQ','RRS','STAI','TEPS_ANT','TEPS_CON'))
melted_cormat$Var2<-factor(melted_cormat$Var2,ordered=TRUE,levels=c('Cat','short_cat','CDS','GAD','PHQ','PSWQ','RRS','STAI','TEPS_ANT','TEPS_CON'))
corrplot<-ggplot(data = melted_cormat, aes(x=Var2, y=Var1, fill=value)) +
geom_tile()+
scale_fill_gradient2(midpoint = 0, low = "navy", mid = "white", high = "red")+
geom_text(aes(Var2, Var1, label = value), color = "black", size = 4)
if (save_images==1){
ggsave(corrplot,filename=paste0(workingdir,'/questionnaire_correlations.png'),width=12,height=9)
}
cor.test(scores$Cat,scores$short_cat)
cor.test(scores$Cat,scores$CDS)
cor.test(scores$Cat,scores$GAD)
cor.test(scores$Cat,scores$PHQ)
cor.test(scores$Cat,scores$PSWQ)
cor.test(scores$Cat,scores$RRS)
cor.test(scores$Cat,scores$STAI)
cor.test(scores$Cat,scores$TEPS_ANT)
cor.test(scores$Cat,scores$TEPS_CON)
cor.test(scores$CDS,scores$STAI)
cor.test(scores$CDS,scores$PSWQ)
data3_scores<-cbind(scores,select(data3,c(contains('medication'),contains('diagnosis'),contains('ID'))))
t.test(data3_scores$GAD[data3_scores$diagnosis_anxdep=='no'],
data3_scores$GAD[data3_scores$diagnosis_anxdep=='yes'])
t.test(data3_scores$PHQ[data3_scores$diagnosis_anxdep=='no'],
data3_scores$PHQ[data3_scores$diagnosis_anxdep=='yes'])
t.test(data3_scores$Cat[data3_scores$diagnosis_general=='no'],
data3_scores$Cat[data3_scores$diagnosis_general=='yes'])
t.test(data3_scores$Cat[data3_scores$diagnosis_anxdep=='no'],
data3_scores$Cat[data3_scores$diagnosis_anxdep=='yes'])
aov_ez('ID','Cat',data3_scores,between=c('medication_general'))
t.test(data3_scores$Cat[data3_scores$medication_general=='Yes I currently take medication'],data3_scores$Cat[data3_scores$medication_general=='Yes I took medication in the past'])
t.test(data3_scores$Cat[data3_scores$medication_general=='Yes I took medication in the past'],data3_scores$Cat[data3_scores$medication_general=='No'])
t.test(data3_scores$Cat[data3_scores$medication_general=='Yes I currently take medication'],data3_scores$Cat[data3_scores$medication_general=='No'])
aov_ez('ID','Cat',data3_scores,between=c('medication_anxdep'))
t.test(data3_scores$Cat[data3_scores$medication_anxdep=='Yes I currently take medication'],data3_scores$Cat[data3_scores$medication_anxdep=='Yes I took medication in the past'])
t.test(data3_scores$Cat[data3_scores$medication_anxdep=='Yes I took medication in the past'],data3_scores$Cat[data3_scores$medication_anxdep=='No'])
t.test(data3_scores$Cat[data3_scores$medication_anxdep=='Yes I currently take medication'],data3_scores$Cat[data3_scores$medication_anxdep=='No'])
data3_scores%>%
group_by(diagnosis_general)%>%
summarize(mean=mean(Cat),sd=sd(Cat),n=length(Cat))
data3_scores%>%
group_by(diagnosis_anxdep)%>%
summarize(mean=mean(Cat),sd=sd(Cat),n=length(Cat))
data3_scores%>%
group_by(medication_general)%>%
summarize(mean=mean(Cat),sd=sd(Cat),n=length(Cat))
data3_scores%>%
group_by(medication_anxdep)%>%
summarize(mean=mean(Cat),sd=sd(Cat),n=length(Cat))
data3_scores$medication_general<-recode(data3_scores$medication_general,"'No'= 1;'Yes I took medication in the past'=2;'Yes I currently take medication'= 3")
data3_scores$medication_anxdep<-recode(data3_scores$medication_anxdep,"'No'= 1;'Yes I took medication in the past'=2;'Yes I currently take medication'= 3")
data3_scores$diagnosis_general<-ifelse(data3_scores$diagnosis_general=='yes',2,1)
data3_scores$diagnosis_anxdep<-ifelse(data3_scores$diagnosis_anxdep=='yes',2,1)
data3_scores$diagnosis_general<-factor(data3_scores$diagnosis_general)
data3_scores$diagnosis_anxdep<-factor(data3_scores$diagnosis_anxdep)
data3_scores$medication_general<-factor(data3_scores$medication_general)
data3_scores$medication_anxdep<-factor(data3_scores$medication_anxdep)
a<-ggplot(data=data3_scores,aes(x=diagnosis_general,y=Cat,fill=diagnosis_general)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(diagnosis_general)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of any mental illness') +
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
scale_x_discrete(breaks=c(1,2),labels=c('No','Yes'))+
theme_classic()+
theme(legend.position='none')
b<-ggplot(data=data3_scores,aes(x=diagnosis_anxdep,y=Cat,fill=diagnosis_anxdep)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(diagnosis_anxdep)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of anxiety or depression') +
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
scale_x_discrete(breaks=c(1,2),labels=c('No','Yes'))+
theme_classic()+
theme(legend.position='none')
c<-ggplot(data=data3_scores,aes(x=medication_general,y=Cat,fill=medication_general)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(medication_general)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of any psychiatric medication use') +
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
scale_x_discrete(breaks=c(1,2,3),labels=c('No','Yes, formerly','Yes, currently'))+
theme_classic()+
theme(legend.position='none')
d<-ggplot(data=data3_scores,aes(x=medication_anxdep,y=Cat,fill=medication_anxdep)) +
geom_flat_violin(position = position_nudge(x = .25, y = 0),adjust =2, trim = FALSE)+
geom_point(position = position_jitter(width = .15), size = .25)+
geom_boxplot(aes(x = as.numeric(medication_anxdep)+0.25, y = Cat),outlier.shape = NA, alpha = 0.3, width = .1, colour = "BLACK") +
labs(y='Catastrophising Score',x='History of medication use for anxiety or depression') +
scale_x_discrete(breaks=c(1,2,3),labels=c('No','Yes, formerly','Yes, currently'))+
scale_fill_manual(values= c("#00AFBB", "#E7B800","#FC4E07"))+
theme_classic()+
theme(legend.position='none')
plot_grid(a,b,c,d,labels='AUTO')
if (save_images==1){
ggsave(file=paste0(workingdir,'/raincloud_plots.pdf'),height=9,width=12)
}
npat_Huys
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
rm(list=ls())
library('MASS')
library('tidyverse')
workingdir='C:/Users/apike/OneDrive - University College London/metaRL/'
plotting=FALSE
source(paste0(workingdir,'/scripts/generate_params.R'))
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
Huys_data
Huys_data<- Huys_data%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
npat_Huys
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
Huys_data<- Huys_data%>%
filter(healthy_highBDI==1||Hx_positivehistory==1||ppx_ppx==1)%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
npat_Huys=Huys_data$group==1
ncon_Huys=Huys_data$group==0
nsub_Huys=nrow(Huys_data)
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
Huys_data<- Huys_data%>%
filter(!healthy_highBDI==1||!Hx_positivehistory==1||!ppx_ppx==1)%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
npat_Huys=Huys_data$group==1
ncon_Huys=Huys_data$group==0
nsub_Huys=nrow(Huys_data)
Huys_data$healthy_lowBDI
sum(Huys_data$healthy_lowBDI)
sum(Huys_data$Hx_nohistory)
sum(Huys_data$ppx_placebo)
nrow(Huys_data)
Huys_data<- Huys_data%>%
filter(!healthy_highBDI==1||!Hx_positivehistory==1||!ppx_ppx==1||!stress_threat==1)%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
Huys_data
nrow(Huys_data)
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
nrow(Huys_data)
nrow(Huys_data)-79
Huys_data<- Huys_data%>%
filter(!(healthy_highBDI==1||Hx_positivehistory==1||ppx_ppx==1||stress_threat==1))%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
Huys_data
nrow(Huys_data)
Huys_data<- Huys_data%>%
filter(!(healthy_highBDI==1|Hx_positivehistory==1|ppx_ppx==1|stress_threat==1))%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
Huys_data
nrow(Huys_data)
sum(nrow(Huys_data$stress_threat==0))
sum(Huys_data$stress_threat==0)
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
sum(Huys_data$stress_threat==0)
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
Huys_data<- Huys_data%>%
filter(healthy_highBDI==0&Hx_positivehistory==0&ppx_ppx==0&stress_threat==0)%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
npat_Huys=Huys_data$group==1
ncon_Huys=Huys_data$group==0
nsub_Huys=nrow(Huys_data)
nsub_Huys
Cavanagh_data<-read.csv(paste0(workingdir,'/data_from_papers/Cavanagh_data.csv'))
Cavanagh_data
Cavanagh_data<-read.csv(paste0(workingdir,'/data_from_papers/Cavanagh_data.csv'))
Cavanagh_data
cor.test(Cavanagh_data$TST_aG,Cavanagh_data$Alex_winlr)
cor.test(Cavanagh_data$TST_aG,Cavanagh_data$Alex_losslr)
cor.test(Cavanagh_data$TST_aL,Cavanagh_data$Alex_losslr)
mean(Cavanagh_data$TST_aL)
mean(Cavanagh_data$TST_aL[Cavanagh_data$SCID==99])
mean(Cavanagh_data$TST_aL[Cavanagh_data$SCID==1])
length(Cavanagh_data$SCID==1)
length(Cavanagh_data$SCID=='1')
sum(Cavanagh_data$SCID=='1')
sum(Cavanagh_data$SCID=='2')
sum(Cavanagh_data$SCID=='99')
11+12+90
sum(Cavanagh_data$SCID=='50')
11+12+90+9
mean(Cavanagh_data$TST_aG)
mean(Cavanagh_data$TST_aL)
mean(Cavanagh_data$Alex_winlr)
mean(Cavanagh_data$Alex_winlr,na.rm=TRUE)
mean(Cavanagh_data$Alex_losslr,na.rm=TRUE)
median(Cavanagh_data$TST_aG)
median(Cavanagh_data$TST_aL)
median(Cavanagh_data$TST_aG)
median(Cavanagh_data$Alex_winlr)
median(Cavanagh_data$Alex_winlr,na.rm=TRUE)
median(Cavanagh_data$Alex_winlr,na.rm=FALSE)
median(Cavanagh_data$Alex_winlr,na.rm=TRUE)
median(Cavanagh_data$Alex_losslr,na.rm=TRUE)
rm(list=ls())
library('MASS')
library('tidyverse')
workingdir='C:/Users/apike/OneDrive - University College London/metaRL/'
plotting=FALSE
source(paste0(workingdir,'/scripts/generate_params.R'))
npat_Chase=18 #number of patients
ncon_Chase=17 #number of controls
nsub_Chase=npat_Chase+ncon_Chase #total participants
Chase_data<-read.csv(paste0(workingdir,'/data_from_papers/Chase_data.csv'))
Chase_params<- Chase_data %>%
filter(pass.fail.exclude==1 & other.exclude==1)%>%
rename(group=Group)%>%
arrange(desc(group))%>%
select(LRateP, LRateN, Beta, group)%>%
rename(alphawin=LRateP,alphaloss=LRateN,beta=Beta)
#nb: 6 controls and 5 patients quit task or did not reach criterion
#ignore the test phase as not learning but PIT
save(Chase_params,file=paste0(workingdir,'/raw_parameters/Chase_params'))
npat_Kumar=25 #n patients
ncon_Kumar=26 #n controls
nsub_Kumar=npat_Kumar+ncon_Kumar #total participants
Kumar_data<-read.csv(paste0(workingdir,'/data_from_papers/Kumar_data.csv'))
Kumar_params<- Kumar_data %>%
mutate(group = ifelse(grepl('D',X),1,0))%>%
arrange(desc(group))%>%
select(Alpha_Avg_Rew, Alpha_Avg_Pun, Beta_Avg_Rew, Beta_Avg_Pun,group)%>%
rename(alpha_win=Alpha_Avg_Rew,alpha_loss=Alpha_Avg_Pun,betawin=Beta_Avg_Rew,betapun=Beta_Avg_Pun)
save(Kumar_params,file=paste0(workingdir,'/raw_parameters/Kumar_params'))
npat_Moutoussis=39 #n patients
ncon_Moutoussis=22 #n controls
nsub_Moutoussis=npat_Moutoussis+ncon_Moutoussis #total participants for paper
Moutoussis_data<-read.csv(paste0(workingdir,'/data_from_papers/Moutoussis_data.csv'))
Moutoussis_params<- Moutoussis_data %>%
mutate(group=ifelse(pt_ID>100,1,0))%>%
arrange(desc(group))%>%
select(lrnRate.tog, bet_Appet.tog, bet_Aver.tog, PavBias.tog, GoBias.tog,irNoiseXi.tog,group)%>%
rename(alpha=lrnRate.tog,winsens=bet_Appet.tog,losssens=bet_Aver.tog, pav=PavBias.tog, go=GoBias.tog,lapse=irNoiseXi.tog)
save(Moutoussis_params,
file=paste0(workingdir,'/raw_parameters/Moutoussis_params'))
npat_Brown=39+20 #n patients (PTSD and MDD civilians)
ncon_Brown=29 #n controls
nsub_Brown=npat_Brown+ncon_Brown #total participants for paper
Brown_data<-read.csv(paste0(workingdir,'/data_from_papers/Brown_data.csv'))
Brown_params<- Brown_data %>%
mutate(group=ifelse(PTSD&MDD.diagnosis==TRUE,1,0))%>%
mutate(rewbeta=ifelse(group==1,7.20,6.35))%>% #one per group
mutate(punbeta=ifelse(group==1,5.05,4.35))%>%
arrange(desc(group))%>%
select(Gain.Learning.Rate, Loss.Learning.Rate, Loss.Associability, Gain.Reward.Sensitivity, Loss.Sensitivity, Gain.Decay, Loss.Decay,rewbeta,punbeta,group)%>%
rename(alphawin=Gain.Learning.Rate,alphaloss=Loss.Learning.Rate,asso=Loss.Associability,rewsens=Gain.Reward.Sensitivity,losssens=Loss.Sensitivity,rewdecay=Gain.Decay,pundecay=Loss.Decay)
save(Brown_params,file=paste0(workingdir,'/raw_parameters/Brown_params'))
#nb S refers to 'safe' not threat here
npat_Mkrtchian=43 #n patients
ncon_Mkrtchian=58 #n controls
nsub_Mkrtchian=npat_Mkrtchian+ncon_Mkrtchian #total participants
Mkrtchian_data<-read.csv(paste0(workingdir,'/data_from_papers/Mkrtchian_data.csv'))
Mkrtchian_params<- Mkrtchian_data %>%
mutate(group=ifelse(Subject>200,1,0))%>%
arrange(desc(group))%>%
select(SLRRewAlpha,SLRPunAlpha,SRewBeta,SPunBeta,SRewPavEpsi,SPunPavEpsi,SActionBias,SNoiseg,group)%>%
rename(alphawin=SLRRewAlpha,alphaloss=SLRPunAlpha,rewsens=SRewBeta,losssens=SPunBeta,winpav=SRewPavEpsi,losspav=SPunPavEpsi,go=SActionBias,lapse=SNoiseg)
save(Mkrtchian_params,file=paste0(workingdir,'/raw_parameters/Mkrtchian_params'))
npat_Aylward=44 #n patients
ncon_Aylward=88 #n controls
nsub_Aylward=npat_Aylward+ncon_Aylward #total subs for paper
Aylward_data<-read.csv(paste0(workingdir,'/data_from_papers/Aylward_data.csv'))
Aylward_params<- Aylward_data %>%
mutate(group=ifelse(Diagnosis=='A',1,0))%>%
arrange(desc(group))%>%
select(Rew_LR,Punish_LR,Rew_Sens,Punish_Sens,Lapse,group)%>%
rename(alphawin=Rew_LR,alphaloss=Punish_LR,rewsens=Rew_Sens,losssens=Punish_Sens,lapse=Lapse)
save(Aylward_params,file=paste0(workingdir,'/raw_parameters/Aylward_params'))
npat_Dombrovski2019=221 #n patients
ncon_Dombrovski2019=74 #n controls
nsub_Dombrovski2019=npat_Dombrovski2019+ncon_Dombrovski2019 #total participants for paper
data1<-read.csv(paste0(workingdir,'/data_from_papers/Dombrovski2019_data.csv'))
data2<-read.csv(paste0(workingdir,'/data_from_papers/Dombrovski2019_mridata.csv'))
data2<-data2%>%
filter(!(data2$ID %in% data1$ID))
Dombrovski_data<-data1%>%
full_join(data2)
library('boot')
Dombrovski_data$beta<-ifelse(!is.na(Dombrovski_data$beta_first_150_transformed),Dombrovski_data$beta_first_150_transformed,exp(Dombrovski_data$beta_mfx_data))
Dombrovski_data$alphawin<-inv.logit(Dombrovski_data$alpha_win_mfx_data)
Dombrovski_data$alphaloss<-inv.logit(Dombrovski_data$alpha_loss_mfx_data)
Dombrovski2019_params<- Dombrovski_data %>%
mutate(group=ifelse(group1245==1,0,1))%>% #controls all in group 1, others in groups 2,4,5, etc
arrange(desc(group))%>%
select(alphawin,alphaloss,beta,decay_mfx_data,group)%>%
rename(decay=decay_mfx_data)
save(Dombrovski2019_params,
file=paste0(workingdir,'/raw_parameters/Dombrovski2019_params'))
npat_Dombrovski2013=33 #n patients
ncon_Dombrovski2013=20 #n controls
nsub_Dombrovski2013=npat_Dombrovski2013+ncon_Dombrovski2013 #total participants for paper
Dombrovski2013_data<-read.csv(paste0(workingdir,'/data_from_papers/Dombrovski2013_data.csv'))
Dombrovski2013_params<- Dombrovski2013_data %>%
mutate(group=ifelse(Group1245==1,0,1))%>% #controls all in group 1, others in groups 2,4,5, etc
arrange(desc(group))%>%
select(phiwin4,philoss4,alpha4,c4,group)%>%
rename(alphawin=phiwin4,alphaloss=philoss4,memory=alpha4,beta=c4)
save(Dombrovski2013_params,
file=paste0(workingdir,'/raw_parameters/Dombrovski2013_params'))
npat_Dombrovski2010=40 #n patients
ncon_Dombrovski2010=14 #n controls
nsub_Dombrovski2010=npat_Dombrovski2010+ncon_Dombrovski2010 #total participants for paper
Dombrovski2010_data<-read.csv(paste0(workingdir,'/data_from_papers/Dombrovski2010_data.csv'))
Dombrovski2010_data<-Dombrovski2010_data%>%
filter(!(Dombrovski2010_data$ID %in% Dombrovski2013_data$ID))
Dombrovski2010_params<- Dombrovski2010_data %>%
mutate(group=ifelse(Group_w_attempt==1,0,1))%>% #controls all in group 1, others in groups 2,4,5, etc
arrange(desc(group))%>%
select(phiwinL,philossL,alphaL,cL,group)%>%
rename(alphawin=phiwinL,alphaloss=philossL,memory=alphaL,beta=cL)
save(Dombrovski2010_params,
file=paste0(workingdir,'/raw_parameters/Dombrovski2010_params'))
npat_Liu=11 #n patients
ncon_Liu=15 #n controls
nsub_Liu=npat_Liu+ncon_Liu #total participants for paper
Liu_data<-read.csv(paste0(workingdir,'/data_from_papers/Liu_data.csv'))
Liu_params<- Liu_data %>%
rename(group=Group.0.ctr.1.mdd.)%>%
arrange(desc(group))%>%
select(Learning.rate,Temperature,group)%>%
rename(alpha=Learning.rate,beta=Temperature)
save(Liu_params,file=paste0(workingdir,'/raw_parameters/Liu_params'))
npat_Blanco=38 #n patients
ncon_Blanco=95 #n controls
nsub_Blanco=npat_Blanco+ncon_Blanco #total participants for paper
Blanco_data<-read.csv(paste0(workingdir,'/data_from_papers/Blanco_data.csv'))
Blanco_params<- Blanco_data %>%
rename(group=depressive)%>%
arrange(desc(group))%>%
select(RLtemp,group)%>%
rename(beta=RLtemp)
save(Blanco_params,file=paste0(workingdir,'/raw_parameters/Blanco_params'))
npat_Millner=85 #n patients
ncon_Millner=44 #n controls
nsub_Millner=npat_Millner+ncon_Millner #total participants for paper
Millner_data<-read.csv(paste0(workingdir,'/data_from_papers/Millner_data_2prior.csv'))
Millner_params<- Millner_data %>%
mutate(group=ifelse(grp_sui_nosui=='1sui',1,0))%>%
arrange(desc(group))%>%
select(T,b0,b1,w1,w2,alpha,omega,group)
Millner_params$T<-ifelse(Millner_params$T<0,0.0001,Millner_params$T)
#nondecision time T - pWiener won't work unless this is greater than 0 - this doesn't really matter anyway
save(Millner_params,
file=paste0(workingdir,'/raw_parameters/Millner_params'))
npat_Mukherjee<-64
ncon_Mukherjee<-64
nsub_Mukherjee<-npat_Mukherjee+ncon_Mukherjee
Mukherjee_data<-read.csv(paste0(workingdir,'/data_from_papers/Mukherjee_data.csv'))
Mukherjee_params<- Mukherjee_data %>%
mutate(group=ifelse(Group=='MDD',1,0))%>%
arrange(desc(group))%>%
select(Alpha_F,Beta_F,Beta_A,Persev_F,Persev_A,Bias_F,Bias_A,Condition,Subject,group)%>%
rename(alpha_f=Alpha_F,beta_f=Beta_F,beta_a=Beta_A,persev_f=Persev_F,persev_a=Persev_A,bias_f=Bias_F,bias_a=Bias_A)%>%
pivot_wider(names_from=Condition,values_from=c(alpha_f,beta_f,beta_a,persev_f,persev_a,bias_f,bias_a))%>%
select(!Subject)#removes subject col
save(Mukherjee_params,file=paste0(workingdir,'/raw_parameters/Mukherjee_params'))
npat_Myers=48 #n patients
ncon_Myers=39 #n controls
nsub_Myers=npat_Myers+ncon_Myers #total participants for paper
Myers_data<-read.csv(paste0(workingdir,'/data_from_papers/myers_data.csv'))
Myers_params<- Myers_data %>%
rename(group=PTSS)%>%
arrange(desc(group))%>%
select(LRG,LRP,BETA,R0,group)%>%
rename(alphawin=LRG,alphaloss=LRP,beta=BETA,r0=R0)
save(Myers_params,file=paste0(workingdir,'/raw_parameters/Myers_params'))
npat_Huang=77
ncon_Huang=45
nsub_Huang=npat_Huang+ncon_Huang
Huang_data<-read.csv(paste0(workingdir,'/data_from_papers/huang_data.csv'))
Huang_params<- Huang_data %>%
rename(group=oasis.8)%>%
arrange(desc(group))%>%
mutate(eta0=rowMeans(select(.,starts_with('eta0'))),
etad=rowMeans(select(.,starts_with('etad'))),
beta=rowMeans(select(.,starts_with('beta'))))%>%
select(eta0,etad,beta,group)
save(Huang_params,file=paste0(workingdir,'/raw_parameters/Huang_params'))
npat_Gradin=15
ncon_Gradin=17
nsub_Gradin=npat_Gradin+ncon_Gradin
Gradin_data<-read.csv(paste0(workingdir,'/data_from_papers/Gradin_data.csv'))
Gradin_params<- Gradin_data %>%
rename(group=Group)%>%
filter(group!='sch')%>%
arrange(desc(group))%>%
rename(alpha=Alpha,beta=Beta)
save(Gradin_params,file=paste0(workingdir,'/raw_parameters/Gradin_params'))
npat_Frey=40
ncon_Frey=51
nsub_Frey=npat_Frey+ncon_Frey
Frey_data<-read.csv(paste0(workingdir,'/data_from_papers/Frey_data.csv'))
Frey_params<- Frey_data %>%
rename(group=group....1..high.BDI..2...low.BDI.)%>%
mutate(group=ifelse(group==2,0,1))%>%
arrange(desc(group))%>%
rename(alpha=Q5_._ns,outcome_valuation=Q5_d_ns,choice_bias=Q5_w_ns,beta=Q5_.._ns)
save(Frey_params,file=paste0(workingdir,'/raw_parameters/Frey_params'))
npat_Khdour=18+20+17
ncon_Khdour=18
nsub_Khdour=npat_Khdour+ncon_Khdour
Khdour_data<-read.csv(paste0(workingdir,'/data_from_papers/Khdour_data.csv'))
Khdour_alpha_pat<-c(
generate_params(n = 18, est_m = Khdour_data$LR[Khdour_data$GROUP=='GAD'], est_sd = Khdour_data$LR[Khdour_data$GROUP=='GAD_SEM']*sqrt(18), plotting, min0=FALSE),
generate_params(n = 20, est_m = Khdour_data$LR[Khdour_data$GROUP=='PAD'], est_sd = Khdour_data$LR[Khdour_data$GROUP=='PAD_SEM']*sqrt(20), plotting, min0=FALSE),
generate_params(n = 17, est_m = Khdour_data$LR[Khdour_data$GROUP=='SAD'], est_sd = Khdour_data$LR[Khdour_data$GROUP=='SAD_SEM']*sqrt(17), plotting, min0=FALSE))
Khdour_alpha_con<- generate_params(n = 18, est_m = Khdour_data$LR[Khdour_data$GROUP=='HC'], est_sd = Khdour_data$LR[Khdour_data$GROUP=='HC_SEM']*sqrt(ncon_Khdour), plotting, min0=FALSE)
Khdour_beta_pat<-c(
generate_params(n = 18, est_m = Khdour_data$Exploration[Khdour_data$GROUP=='GAD'], est_sd = Khdour_data$Exploration[Khdour_data$GROUP=='GAD_SEM']*sqrt(18), plotting, min0=FALSE),
generate_params(n = 20, est_m = Khdour_data$Exploration[Khdour_data$GROUP=='PAD'], est_sd = Khdour_data$Exploration[Khdour_data$GROUP=='PAD_SEM']*sqrt(20), plotting, min0=FALSE),
generate_params(n = 17, est_m = Khdour_data$Exploration[Khdour_data$GROUP=='SAD'], est_sd = Khdour_data$Exploration[Khdour_data$GROUP=='SAD_SEM']*sqrt(17), plotting, min0=FALSE))
Khdour_beta_con<- generate_params(n = 18, est_m = Khdour_data$Exploration[Khdour_data$GROUP=='HC'], est_sd = Khdour_data$Exploration[Khdour_data$GROUP=='HC_SEM']*sqrt(ncon_Khdour), plotting, min0=FALSE)
Khdour_params<-data.frame(alpha=c(Khdour_alpha_pat,
Khdour_alpha_con),
beta=c(Khdour_beta_pat,
Khdour_beta_con),
group=c(rep(1,npat_Khdour),
rep(0,ncon_Khdour)))
save(Khdour_params,file=paste0(workingdir,'/raw_parameters/Khdour_params'))
npat_White=47
ncon_White=32
nsub_White=npat_White+ncon_White
White_data<-read.csv(paste0(workingdir,'/data_from_papers/White_data.csv'))
White_params<- White_data %>%
mutate(group=ifelse(Subject<2000,1,0))%>% #8000s = HC, 1000s=pat
arrange(desc(group))%>%
select(lrp,alpha,group)%>%
rename(alpha=lrp,beta=alpha)
save(White_params,file=paste0(workingdir,'/raw_parameters/White_params'))
Huys_data<-read.csv(paste0(workingdir,'/data_from_papers/Huys_data.csv'))
Huys_data<- Huys_data%>%
filter(healthy_highBDI==0&Hx_positivehistory==0&ppx_ppx==0&stress_threat==0)%>%
mutate(group=ifelse(healthy_highBDI==1||MDD_depressed==1||BPD_euthymic==1,1,0))
npat_Huys=Huys_data$group==1
ncon_Huys=Huys_data$group==0
nsub_Huys=nrow(Huys_data)
